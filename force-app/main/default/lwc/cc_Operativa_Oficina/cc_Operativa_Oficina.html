<template>
    <section role="dialog" tabindex="-1" aria-modal="true" class="modal slds-modal" onkeydown={modalTeclaPulsada}>
        <div class="slds-modal__container">
            <!-- sldsValidatorIgnoreNextLine -->
            <lightning-button-icon icon-name="utility:close" size="large" onclick={cerrarModal} class="slds-modal__close"></lightning-button-icon>
            <div class="slds-modal__header">
                <h1 class="slds-modal__title slds-hyphenate">Derivar</h1>
            </div>
            <div class="slds-modal__content slds-var-p-vertical_large slds-var-p-horizontal_xx-large" style="text-align: start;overflow: visible;">
                <lightning-spinner if:true={showSpinner} alternative-text="Cargando..." variant="brand" size="medium" class="spin-cls" style="position: absolute;"></lightning-spinner>
                <div lwc:if={alertaTexto} style="text-align: center;">
                    <p>{alertaTexto}</p>
                    <p class="slds-var-m-top_medium">¿Quieres continuar con el proceso?</p>
                </div>
                <div lwc:elseif={ambitoFraude} style="text-align: center;">
                    <template if:true={preguntaSenal}>
                        <p>{preguntaSenal}</p>
                    </template>
                    <template if:true={mostrarModalPreguntaRealizarRemitido}>
                        <div lwc:if={preguntaRealizarRemitido} style="text-align: center;">
                            <p>{preguntaRealizarRemitido}</p>
                        </div>
                    </template>
                </div>
                <div lwc:elseif={grupoColaborador} style="text-align: center;">
                    <p>{preguntaGrupoColaborador}</p>
                </div>
                <template lwc:else>
                    <div lwc:if={preguntaCajeros} style="text-align: center;">
                        <p>{preguntaCajeros}</p>
                    </div>
                    <div lwc:elseif={preguntaCajerosExternos} style="text-align: center;">
                        <p>{preguntaCajerosExternos}</p>
                    </div>
                    <div lwc:elseif={preguntaCSBDContratar} style="text-align: center;">
                        <p>{preguntaCSBDContratar}</p>
                        <br>
                        <div>
                            <lightning-button label="TF" icon-name="utility:trending" title="TF" onclick={linkTF}></lightning-button>
                        </div>
                    </div>
                    <div lwc:elseif={preguntaCSBDContratar2} style="text-align: center;">
                        <p>{preguntaCSBDContratar2}</p>
                    </div>
                    <!--<template if:true={mostrarModalPreguntaEnrollmentDatos}>
                        <div lwc:if={preguntaEnrollmentDatos} style="text-align: left;">
                            <lightning-formatted-text value={preguntaEnrollmentDatos} >   
                            </lightning-formatted-text>
                        </div>
                    </template>-->
                    <!--<template if:false={mostrarModalPreguntaEnrollmentDatos}>
                        <div lwc:if={preguntaEnrollment} style="text-align: center;">
                            <p>{preguntaEnrollment}</p>
                        </div>
                    </template>-->
                    <!--<template if:true={mostrarModalPreguntaRealizarRemitido}>
                        <div lwc:if={preguntaRealizarRemitido} style="text-align: center;">
                            <p>{preguntaRealizarRemitido}</p>
                        </div>
                    </template>-->
                    <!--<template if:false={mostrarModalPreguntaRealizarRemitido}>
                        <div lwc:if={preguntaSenal} style="text-align: center;">
                            <p>{preguntaSenal}</p>
                        </div>
                    </template>-->
                    <template lwc:elseif={mostrarModalCreacionTarea}>
                        <div lwc:if={cargandoGestor} class="slds-is-relative" style="height: 55px;" align="center">
                            <lightning-spinner variant="brand" style="position: absolute;"></lightning-spinner>
                        </div>
                        <template lwc:else>
                            <template lwc:if={numeroGestorKO}>
                                <div style="margin: 10px">
                                    <span style="margin-right: 10px" class="slds-icon_container">
                                        <lightning-icon icon-name="utility:warning" variant="warning" size="x-small"></lightning-icon>
                                    </span>
                                    <b>No es posible crear una tarea</b>
                                    <p style="margin-top: 10px">{mensajeErrorInt}</p>
                                </div>
                            </template>
                            <template lwc:else>
                                <div style="font-size: 14px; font-weight: 700;">Nueva tarea</div>
                                <div class="slds-grid slds-gutters slds-var-m-top_medium">
                                    <div class="slds-col slds-size_2-of-3">
                                        <lightning-input required="true" label="Asunto" maxlength="255"
                                        value="Solicitud contacto gestor (Contact Center)"
                                        disabled="true"></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-input class="fechaActividad" type="date" value={fecha}
                                        label="Fecha actividad" required="true"></lightning-input>
                                    </div>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-1 slds-var-m-top_medium">
                                        <lightning-textarea class="comentariosTarea" required="true" label="Comentarios"
                                        value={comentariosTarea}></lightning-textarea>
                                    </div>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-1 slds-var-m-top_medium">
                                        <lightning-file-upload class="archivosTarea" label="Archivos" 
                                        accept={acceptedFormats} onuploadfinished={handleUploadFinished} multiple="true"
                                        value={archivos}></lightning-file-upload>
                                    </div>
                                </div>
                                <br><p>Se han subido {archivosLength} archivos</p>
                                <div class="slds-var-m-top_xx-large slds-var-m-bottom_large"
                                style="font-size: 14px; font-weight: 700;">Asignada </div>
                                <template lwc:if={cambioOficina}>
                                    <template lwc:if={toastNoCliente}>
                                        La oficina destino.
                                    </template>
                                    <template lwc:else>
                                        Todos los empleados con funcion DIRECCION de la oficina destino.
                                    </template>
                                </template>
                                <template if:false={cambioGestor}>
                                    <template if:false={cambioOficina}>
                                        <template if:false={mostrarBuscadorGestor}>
                                            <lightning-icon class="slds-var-m-right_small" icon-name="standard:user" size="x-small"></lightning-icon>{nombreGestor}
                                            <div style="margin-top: 15px;">
                                                <template if:false={gestorAsignadoCoincide}>
                                                    <template lwc:if={gestorGenerico}>
                                                        <div class="slds-grid slds-grid_vertical-align-center slds-gutters_direct-x-small">
                                                            <div class="slds-col slds-grow-none">
                                                                <lightning-icon icon-name="utility:info_alt" size="x-small"></lightning-icon>
                                                            </div>
                                                            <div class="slds-col">
                                                                El gestor disponible para su atención no coincide con el asignado al cliente: {nombreGestorAsignado}.
                                                            </div>
                                                        </div>
                                                    </template>
                                                </template>
                                                <template lwc:if={gestorGenerico}> Se asignará a un gestor genérico.</template>
                                            </div>
                                        </template>
                                    </template>
                                </template>
                                <template lwc:if={cambioOficina}>
                                    <!-- Lookup -->
                                    <div class="slds-form-element slds-var-p-bottom_medium slds-var-m-top_medium">
                                        <div class="slds-form-element__control">
                                            <template lwc:if={lookupOficinaResultadoSeleccionado}>
                                                <!-- Con resultado seleccionado -->
                                                <label class="slds-form-element__label"><abbr class="slds-required">*</abbr>Oficina destino</label>
                                                <div class="slds-combobox_container slds-has-selection">
                                                    <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click">
                                                        <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_left-right" role="none">
                                                            <span class="slds-icon_container slds-combobox__input-entity-icon slds-var-m-left_xx-small">
                                                                <lightning-icon icon-name="standard:account" size="x-small"></lightning-icon>
                                                            </span>
                                                            <div role="combobox" tabindex="0" class="slds-input_faux slds-combobox__input slds-combobox__input-value" aria-expanded="false" aria-haspopup="listbox">
                                                                <span class="slds-truncate">{lookupOficinaResultadoSeleccionado.Name}</span>
                                                            </div>
                                                            <span class="slds-input__icon slds-input__icon_right" style="pointer-events: initial; top: calc(50% - 1px);">
                                                                <lightning-button-icon icon-name="utility:close" size="small" variant="bare" tooltip="Deseleccionar" onclick={lookupDeseleccionar}></lightning-button-icon>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </template>
                                            <template lwc:else>
                                                <!-- Sin resultado seleccionado (buscador) -->
                                                <div class="slds-combobox_container">
                                                    <div class="lookupOficina slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click">
                                                        <!-- Input de búsqueda -->
                                                        <label class="slds-form-element__label"><abbr class="slds-required">*</abbr>Oficina destino</label>
                                                        <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                            <lightning-input class="lookupOficinaInput" type="search" variant="label-hidden" value={lookupOficinaInputValue} placeholder="Buscar por ciudad o calle" autocomplete="off" onchange={lookupOficinaOnchange} onfocus={lookupOficinaAbrir} onblur={lookupOficinaCerrar}></lightning-input>
                                                        </div>
                                                        <!-- Lista de resultados -->
                                                        <div lwc:if={lookupOficinaResultados.length} class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox" tabindex="0" aria-busy="false">
                                                            <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                <template for:each={lookupOficinaResultados} for:item="resultado">
                                                                    <!-- Resultado -->
                                                                    <li key={resultado.Id} role="presentation" class="slds-listbox__item" onclick={lookupOficinaSeleccionar} data-id={resultado.Id}>
                                                                        <div class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option">
                                                                            <!-- Icono del resultado -->
                                                                            <span class="slds-media__figure slds-listbox__option-icon slds-is-relative" style="top: -2px;">
                                                                                <lightning-icon icon-name="standard:account" size="x-small"></lightning-icon>
                                                                            </span>
                                                                            <span class="slds-media__body">
                                                                                <!-- Título del resultado -->
                                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity">{resultado.Name}</span>
                                                                                <!-- Subtítulo del resultado -->
                                                                                <span class="slds-listbox__option-meta slds-listbox__option-meta_entity" style="font-weight: 300; padding-top: 1px;">{resultado.BillingCity} - {resultado.BillingStreet}</span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                </template>
                                                            </ul>
                                                        </div>
                                                        <template lwc:else>
                                                            <!-- Mensaje si no hay resultados -->
                                                            <div lwc:if={lookupOficinaInputValue} class="slds-dropdown slds-dropdown_length-with-icon-5 slds-dropdown_fluid" role="listbox" tabindex="0" aria-busy="false">
                                                                <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                    <li role="presentation" class="slds-listbox__item">
                                                                        <div aria-selected="true" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term slds-has-focus" role="option" style="cursor: default;">
                                                                            <span class="slds-media__body">
                                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity slds-text-color_weak">No hay resultados.</span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                                <template lwc:if={cambioGestor}>
                                    <lightning-combobox name="comboboxGestor" label="Gestores disponibles" value="" placeholder="Selecciona un gestor" options={gestores} required></lightning-combobox>
                                </template>
                                <template lwc:if={mostrarBuscadorGestor}>
                                    <!-- Lookup Gestor -->
                                    <div class="slds-form-element slds-var-p-bottom_medium slds-var-m-top_medium">
                                        <div class="slds-form-element__control">
                                            <template lwc:if={lookupGestorResultadoSeleccionado}>
                                                <!-- Con resultado seleccionado -->
                                                <label class="slds-form-element__label"><abbr class="slds-required">*</abbr>Gestores disponibles</label>
                                                <div class="slds-combobox_container slds-has-selection">
                                                    <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click">
                                                        <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_left-right" role="none">
                                                            <span class="slds-icon_container slds-combobox__input-entity-icon slds-var-m-left_xx-small">
                                                                <lightning-icon icon-name="standard:account" size="x-small"></lightning-icon>
                                                            </span>
                                                            <div role="combobox" tabindex="0" class="slds-input_faux slds-combobox__input slds-combobox__input-value" aria-expanded="false" aria-haspopup="listbox">
                                                                <span class="slds-truncate">{lookupGestorResultadoSeleccionado.Name}</span>
                                                            </div>
                                                            <span class="slds-input__icon slds-input__icon_right" style="pointer-events: initial; top: calc(50% - 1px);">
                                                                <lightning-button-icon icon-name="utility:close" size="small" variant="bare" tooltip="Deseleccionar" onclick={lookupGestorDeseleccionar}></lightning-button-icon>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </template>
                                            <template lwc:else>
                                                <!-- Sin resultado seleccionado (buscador) -->
                                                <div class="slds-combobox_container">
                                                    <div class="lookupGestor slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click">
                                                        <!-- Input de búsqueda -->
                                                        <label class="slds-form-element__label"><abbr class="slds-required">*</abbr>Gestores disponibles</label>
                                                        <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right" role="none">
                                                            <lightning-input class="lookupGestorInput" type="search" variant="label-hidden" value={lookupGestorInputValue} placeholder="Buscar por nombre" autocomplete="off" onchange={lookupGestorOnchange} onfocus={lookupGestorAbrir} onblur={lookupGestorCerrar}></lightning-input>
                                                        </div>
                                                        <!-- Lista de resultados -->
                                                        <div lwc:if={lookupGestorResultados.length} class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid" role="listbox" tabindex="0" aria-busy="false">
                                                            <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                <template for:each={lookupGestorResultados} for:item="resultado">
                                                                    <!-- Resultado -->
                                                                    <li key={resultado.Id} role="presentation" class="slds-listbox__item" onclick={lookupGestorSeleccionar} data-id={resultado.Id}>
                                                                        <div class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option">
                                                                            <!-- Icono del resultado -->
                                                                            <span class="slds-media__figure slds-listbox__option-icon slds-is-relative" style="top: -2px;">
                                                                                <lightning-icon icon-name="standard:account" size="x-small"></lightning-icon>
                                                                            </span>
                                                                            <span class="slds-media__body">
                                                                                <!-- Título del resultado -->
                                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity">{resultado.Name}</span>
                                                                                <!-- Subtítulo del resultado -->
                                                                                <span class="slds-listbox__option-meta slds-listbox__option-meta_entity" style="font-weight: 300; padding-top: 1px;">{resultado.Account.BillingCity} - {resultado.Account.BillingStreet}</span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                </template>
                                                            </ul>
                                                        </div>
                                                        <template lwc:else>
                                                            <!-- Mensaje si no hay resultados -->
                                                            <div lwc:if={lookupGestorInputValue} class="slds-dropdown slds-dropdown_length-with-icon-5 slds-dropdown_fluid" role="listbox" tabindex="0" aria-busy="false">
                                                                <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                                                                    <li role="presentation" class="slds-listbox__item">
                                                                        <div aria-selected="true" class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_term slds-has-focus" role="option" style="cursor: default;">
                                                                            <span class="slds-media__body">
                                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity slds-text-color_weak">No hay resultados.</span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                            </template>
                        </template>
                    </template>
                    <!-- INICIO CITA GESTOR-->
                    <template lwc:elseif={mostrarModalCita}>
                        <!--<c-cc_-modal_-cita_-gestor record-id={recordId}></c-cc_-modal_-cita_-gestor>-->
                        <div lwc:if={cargandoGestor} style="height: 55px;" align="center">
                            <lightning-spinner size="small" variant="brand" style="position: absolute;"
                            alternativetext="Cargando..."></lightning-spinner>
                        </div>
                        <template if:false={cargandoGestor}>
                            <template lwc:if={numeroGestorKO}>
                                <div style="margin: 10px">
                                    <span style="margin-right: 10px" class="slds-icon_container">
                                        <lightning-icon icon-name="utility:warning" variant="warning"
                                        size="x-small"></lightning-icon>
                                    </span>
                                    <b>No es posible agendar un evento</b>
                                    <p style="margin-top: 10px">{mensajeErrorInt}</p>
                                </div>
                            </template>
                            <template lwc:else>
                                <template lwc:if={tieneGestor}>
                                    <div style="font-size: 14px;font-weight: 700;">Nuevo evento</div>
                                    <div class="slds-var-m-top_medium">
                                        <template lwc:if={esClienteDigital}>
                                            <lightning-select class="tipoCitaDigital" name="tipoCita" label="Tipo de cita" required="true" options={opcionesCitaDigital}></lightning-select>
                                        </template>
                                        <template lwc:else>
                                            <template lwc:if={ocultarOpcionCitaGestor}>
                                                <lightning-select class="tipoCitaOcultada" name="tipoCita" label="Tipo de cita" required="true" onchange={resetDisponibilidadConsultada} options={opcionesCitaDigital}></lightning-select>
                                            </template>
                                            <template lwc:else>
                                                <lightning-select class="tipoCita" name="tipoCita" label="Tipo de cita" required="true" onchange={resetDisponibilidadConsultada} options={opcionesCita}></lightning-select>
                                            </template>
                                        </template>
                                        <lightning-input name="asuntoEvento" required="true" label="Asunto" maxlength="200"
                                        class="asuntoEvento slds-var-m-top_medium"></lightning-input>
                                        <template if:false={gestorBackupActivo}>
                                            <div class="slds-var-m-top_xx-large" style="font-size:14px; font-weight:700;">
                                                Asignado a</div>
                                                <div style="margin-top:10px;">
                                                    <span style="padding-right:10px;" class="slds-icon">
                                                        <lightning-icon class="slds-var-m-right_small" icon-name="standard:user"
                                                        size="x-small"></lightning-icon>
                                                    </span>
                                                    {nombreGestor}
                                                </div>
                                                <div style="margin-top:15px;">
                                                    <template if:false={gestorAsignadoCoincide}>
                                                        <span style="margin-right: 5px" class="slds-icon_container">
                                                            <lightning-icon icon-name="utility:info_alt" size="x-small"></lightning-icon>
                                                        </span>
                                                        El gestor disponible no coincide con el asignado al
                                                        cliente: {nombreGestorAsignado}.
                                                    </template>
                                                </div>
                                                <div>
                                                    <div class="slds-var-m-top_xx-large"
                                                    style="font-size:14px;font-weight:700; margin-bottom:10px;">
                                                    Fecha y hora</div>
                                                    <template if:false={disponibilidadConsultada}>
                                                        <lightning-button label="Consultar disponibilidad"
                                                        icon-name="utility:search" title="Consultar disponibilidad"
                                                        onclick={consultarFechasDisponibilidadGestor}></lightning-button>
                                                    </template>
                                                    <template if:true={disponibilidadConsultada}>
                                                        <div class="slds-grid slds-gutters cc_modalCitaGestor_div_comboboxes">
                                                            <div class="citaGestorFechaBackUpFalse slds-col slds-size_1-of-2">
                                                                <lightning-combobox label="Fecha" class="fechasDisponibilidad"
                                                                placeholder="--Seleccione una fecha--"
                                                                options={fechasDisponibilidad}
                                                                onchange={consultarHorasDisponibilidadGestor}></lightning-combobox>
                                                            </div>
                                                            <div class="horasDisponibilidad1 slds-col slds-size_1-of-2">
                                                                <lightning-combobox label="Hora"
                                                                placeholder="--Seleccione una hora--"
                                                                options={horasDisponibilidad}
                                                                onchange={guardarHorasDisponibilidad}></lightning-combobox>
                                                            </div>
                                                        </div>
                                                    </template>
                                                </div>
                                            </template>
                                            <div>
                                                <div class="slds-var-m-top_xx-large"
                                                style="font-size:14px;font-weight:700; margin-bottom:10px;">
                                                Otros gestores
                                            </div>
                                            <lightning-input name="checkbox" type="toggle"
                                            checked={gestorBackupActivo} onchange={mostrarGestorBackup}
                                            messagetoggleactive="Gestor backup" messagetoggleinactive="Gestor asignado"
                                            disabled="true"></lightning-input>
                                        </div>
                                        <template if:true={gestorBackupActivoDos}>
                                            <template if:true={existeBackup}>
                                                <div class="slds-col slds-size_1-of-1"
                                                style="margin-top:15px; margin-bottom:10px;">
                                                <lightning-combobox label="Gestor backup"
                                                placeholder="--Seleccione un gestor--" options={gestoresBackup}
                                                onchange={resetDisponibilidadConsultada}></lightning-combobox>
                                                <div>
                                                    <div
                                                    style="font-size:14px;font-weight:700; margin-top:15px; margin-bottom:10px;">
                                                    Fecha y hora
                                                </div>
                                                <template if:false={disponibilidadConsultada}>
                                                    <lightning-button label="Consultar disponibilidad"
                                                    icon-name="utility:search" title="Consultar disponibilidad"
                                                    onclick={consultarFechasDisponibilidadBackup}></lightning-button>
                                                </template>
                                                <template if:true={disponibilidadConsultada}>
                                                    <div
                                                    class="slds-grid slds-gutters cc_modalCitaGestor_div_comboboxes">
                                                    <div class="horasDisponibilidad slds-col slds-size_1-of-2">
                                                        <lightning-combobox class="fechasDisponibilidad"
                                                        label="Fecha" placeholder="--Seleccione una fecha--"
                                                        options={fechasDisponibilidad}
                                                        onchange={consultarHorasDisponibilidadBackup}></lightning-combobox>
                                                    </div>
                                                    <div class="horasDisponibilidad slds-col slds-size_1-of-2">
                                                        <lightning-combobox
                                                        label="Hora" placeholder="--Seleccione una hora--"
                                                        options={horasDisponibilidad}></lightning-combobox>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </template>
                                <template if:false={existeBackup}>
                                    <div style="margin-top:15px;">
                                        <span style="margin-right: 5px; margin-left: 5px;"
                                        class="slds-icon_container">
                                        <lightning-icon icon-name="utility:info_alt"
                                        size="small"></lightning-icon>
                                    </span>
                                    No existen backups asignados al gestor de este cliente.
                                </div>
                            </template>
                        </template>
                        <div>
                            <div class="slds-var-m-top_xx-large" style="margin-top:15px;font-size:14px;font-weight:700; margin-bottom:10px;">
                                La cita no cumple las expectativas del cliente. Quiero crear una tarea.
                            </div>
                            <div >
                                <lightning-input class ="checkBoxCitaGestor" type="toggle" onchange={checkCrearTareaOnchange}></lightning-input>
                            </div>
                        </div>
                    </div>
                </template>
                <template lwc:else>
                    <div style="margin: 10px">
                        <span style="margin-right: 10px" class="slds-icon_container">
                            <lightning-icon icon-name="utility:warning" variant="warning"
                            size="x-small"></lightning-icon>
                        </span>
                        <b>No es posible agendar un evento</b>
                        <p style="margin-top: 10px">El cliente relacionado con este caso no tiene un
                            gestor asignado. </p>
                        </div>
                    </template>
                </template>
            </template>
        </template>
        <!-- FIN CITA GESTOR-->
        <div lwc:elseif={mostrarModalGestionGestorAsignado} style="text-align: center;">
            <p>¿La gestión a realizar es con el gestor del cliente?</p>
        </div>
        <div lwc:elseif={mostrarModalGestionGestorGenerico} style="text-align: center;">
            <p>¿La gestión a realizar es con la oficina gestora del cliente?</p>
        </div>
        <template lwc:elseif={mostrarModalDNITestamentaria}>
            <div style="text-align: center;">
                <lightning-input class="DNITestamentaria slds-align_absolute-center" label="Introduzca el documento de identidad del difunto" placeholder="Documento" value={DNITestamentaria} required="true"></lightning-input>
            </div>
        </template>
        <template lwc:elseif={mostrarFlowDerivar}>
            <lightning-flow flow-api-name='CC_Procesos_Cajeros' flow-input-variables={inputVariables} onstatuschange={handleStatusChange}> </lightning-flow>
        </template>
    </template>
</div>
<div class="slds-modal__footer">
    <div lwc:if={alertaTexto} style="text-align: center;">
        <lightning-button label="Continuar" variant="brand" onclick={handleContinuarProceso}></lightning-button>
        <lightning-button class="botonCancelar slds-var-m-left_small" label="Cancelar" onclick={cerrarModal}></lightning-button>
    </div>
    <div lwc:elseif={ambitoFraude} style="text-align: center;">
        <template if:false={mostrarModalPreguntaRealizarRemitido}>
            <template lwc:if={preguntaSenal}>
                <lightning-button label="Si" variant="brand" onclick={handlePreguntaSenalSi}></lightning-button>
                <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={handleMostrarPreguntaRealizarRemitido}></lightning-button>
            </template>
        </template>
        <template if:true={mostrarModalPreguntaRealizarRemitido}>
            <template lwc:if={preguntaRealizarRemitido}>
                <lightning-button label="Si" variant="brand" onclick={handleRemitir}></lightning-button>
                <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={handleMostrarMensajeRemitir}></lightning-button>
            </template>
        </template>
    </div>    
    <div lwc:elseif={grupoColaborador} style="text-align: center;">
        <lightning-button label="Derivar" variant="brand" onclick={handleGrupoColaboradorDerivar}></lightning-button>
        <lightning-button label="Trasladar" onclick={handleGrupoColaboradorTrasladar} class="botonCancelar slds-var-m-left_small"></lightning-button>
    </div>
    <div lwc:else style="text-align: center;">
        <template lwc:if={mostrarModalDNITestamentaria}>
            <div style="text-align: center; margin-top:15px; margin-bottom:10px;">
                <lightning-button label="Aceptar" variant="brand" onclick={comprobarDNI} class="slds-m-horizontal_small"></lightning-button>
                <lightning-button label="Cancelar" onclick={cerrarModal} class="slds-m-horizontal_small"></lightning-button>
            </div>
        </template>
        <template lwc:elseif={mostrarModalCreacionTarea}>
            <lightning-button label="Crear tarea" variant="brand"
            onclick={handleCrearTareaGestor}></lightning-button>
            <lightning-spinner if:true={showSpinner} alternative-text="Cargando..." variant="brand" size="medium" class="spin-cls" style="position: absolute;"></lightning-spinner>
            <lightning-button class="slds-var-m-left_small" label="Cancelar"
            onclick={cerrarModal}></lightning-button>
        </template>
        <template lwc:elseif={preguntaCajeros}>
            <lightning-button label="Si" variant="brand" onclick={preguntaCajerosSi}></lightning-button>
            <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={preguntaCajerosNo}></lightning-button>
        </template>
        <template lwc:elseif={preguntaCajerosExternos}>
            <lightning-button label="Si" variant="brand" onclick={preguntaCajerosExternosSi}></lightning-button>
            <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={preguntaCajerosExternosNo}></lightning-button>
        </template>
        <template lwc:elseif={preguntaCSBDContratar}>
            <lightning-button label="Si" variant="brand" onclick={preguntaCSBDContratarSi}></lightning-button>
            <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={preguntaCSBDContratarNo}></lightning-button>
        </template>
        <template lwc:elseif={preguntaCSBDContratar2}>
            <lightning-button label="Si" variant="brand" onclick={preguntaCSBDContratar2Si}></lightning-button>
            <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={preguntaCSBDContratar2No}></lightning-button>
        </template>
        <!--<template if:false={mostrarModalPreguntaEnrollmentDatos}>
            <template lwc:if={preguntaEnrollment}>
                <lightning-button label="Si" variant="brand" onclick={handleMostrarEnrollmentDatos}></lightning-button>
                <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={preguntaEnrollmentNo}></lightning-button>
            </template>
        </template>-->
        <!--<template if:true={mostrarModalPreguntaEnrollmentDatos}>
            <template lwc:if={preguntaEnrollmentDatos}>
                <lightning-button label="Si" variant="brand" onclick={preguntaEnrollmentDatosSi}></lightning-button>
                <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={preguntaEnrollmentDatosNo}></lightning-button>
            </template>
        </template>-->
        <!--<template if:false={mostrarModalPreguntaRealizarRemitido}>
            <template lwc:if={preguntaSenal}>
                <lightning-button label="Si" variant="brand" onclick={handlePreguntaSenalSi}></lightning-button>
                <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={handleMostrarPreguntaRealizarRemitido}></lightning-button>
            </template>
        </template>-->
        <template lwc:elseif={mostrarModalPreguntaRealizarRemitido}>
            <template lwc:if={preguntaRealizarRemitido}>
                <lightning-button label="Si" variant="brand" onclick={handleRemitir}></lightning-button>
                <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={handleMostrarMensajeRemitir}></lightning-button>
            </template>
        </template>
        <template lwc:elseif={mostrarModalGestionGestorAsignado}>
            <lightning-button label="Si" variant="brand" onclick={handleAbrirModalCita}></lightning-button>
            <lightning-button label="No" class="botonCancelar slds-var-m-left_small" onclick={handleGestionGestorAsignadoNo}></lightning-button>
        </template>
        <template lwc:elseif={mostrarModalGestionGestorGenerico}>
            <lightning-button label="Si" variant="brand" onclick={handleGestionGestorDistintoSi}></lightning-button>
            <lightning-button label="No" onclick={handleGestionGestorDistintoNo} class="botonCancelar slds-var-m-left_small"></lightning-button>
        </template>
        <template lwc:elseif={mostrarModalCita}>
            <template if:false={numeroGestorKO}>
                <template lwc:if={tieneGestor}>
                    <template lwc:if={mostrarTareaModalCitaGestor}>
                        <lightning-button label="Crear tarea" variant="brand" onclick={ocultarModalCitaGestor}></lightning-button>
                    </template>
                    <template if:false={mostrarTareaModalCitaGestor}>
                        <lightning-button label="Agendar cita gestor" variant="brand" disabled={ocultarBotonCita} onclick={confirmarCitaGestor}></lightning-button>
                    </template>
                    <lightning-button label="Cancelar" onclick={cerrarModal} class="slds-var-m-left_small"></lightning-button>
                </template>
            </template>
        </template>
    </div>
</div>
</div>
</section>
<div class="backdrop slds-backdrop"></div>
</template>