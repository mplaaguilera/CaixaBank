<template>
    <div>
        <span> 
            <lightning-icon size="small" icon-name="standard:opportunity"></lightning-icon><strong>&nbsp;&nbsp; Oportunidades (Vinculadas {opposCount})</strong>
        </span>
    </div>
    <div class = "cardMargin">
        <div class="basicContainer cardMargin">
            <div class="slds-grid">
                <c-av_-lookup data-id="clookup1" class="productNew"
                selection={initialSelection} 
                errors={errors} 
                onsearch={handleSearchProduct}
                onselectionchange={handleSelectionChange} 
                fieldlabel="Añadir oportunidad"
                placeholder="Buscar producto..." >
                </c-av_-lookup>
                <lightning-button class="buttonAñadir" label="Añadir" disabled={productToAdd} onclick={handleAddOppo}></lightning-button>
            </div>
        </div>
        <span if:true={showOppoListRecord}>{titleOppRecord}</span>
        <template if:true={showOppoListRecord} for:each={oppoListRecord} for:item="opp">
            <div key={opp.Id} class="cardMargin"> 
                <c-av_-detail-opportunity-appointment
                    oppo={opp} 
                    onvinculateaction={handleVinculation}
                    onmainclick={handleMainOpp}
                    onsenddatafromoppo={buildOppoObj}
                    onnotifyagended={evaluateAgendeds}
                    data-id={opp.Id}
                    resolutionlist={resolutionList}
                    potentiallist={potentialList}
                    isnewprod ={opp.IsNewProduct}
                ></c-av_-detail-opportunity-appointment>
            </div>
        </template>
        <span if:true={showOtherOppsLabel}>Otras oportunidades del cliente</span>
        <template if:true={showOppoList} for:each={oppoList} for:item="opp">
            <div key={opp.Id} class="cardMargin"> 
                <c-av_-detail-opportunity-appointment
                    oppo={opp} 
                    onvinculateaction={handleVinculation}
                    onmainclick={handleMainOpp}
                    onsenddatafromoppo={buildOppoObj}
                    onnotifyagended={evaluateAgendeds}
                    data-id={opp.Id}
                    resolutionlist={resolutionList}
                    potentiallist={potentialList}
                    isnewprod ={opp.IsNewProduct}
                ></c-av_-detail-opportunity-appointment>
                
            </div>
        </template>
        <template for:each={oppoNewList} for:item="opp">
            <div key={opp.Id} class="cardMargin"> 
                <c-av_-detail-opportunity-appointment 
                    oppo={opp} 
                    onvinculateaction={handleVinculation}
                    onmainclick={handleMainOpp}
                    onsenddatafromoppo={buildOppoObj}
                    onnotifyagended={evaluateAgendeds}
                    data-id={opp.Id}
                    resolutionlist={resolutionList}
                    potentiallist={potentialList}
                    buttondelete={showButtonDelete}
                    ondeleteoppo={handleOppoDelete}
                    isnewprod ={opp.IsNewProduct}
                    ></c-av_-detail-opportunity-appointment>
            </div>
        </template>
    </div>
    
</template>