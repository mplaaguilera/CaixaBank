<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>AV_TaskEditableByStatus</fullName>
    <active>true</active>
    <description>Un usuario de SSCC solo puede modificar el estado de &apos;Pendiente no localizado&apos; a &apos;Gestionada positiva&apos;, &apos;Gestionada negativa&apos; o &apos;Desactivada&apos;</description>
    <errorConditionFormula>AND( 
  ISCHANGED( Status ),
  NOT( ISNEW() ),
  ActivityDate &lt;= TODAY(),
  ISPICKVAL(PRIORVALUE(Status) , &quot;Pendiente no localizado&quot;),
  NOT(ISPICKVAL(Status, &quot;Gestionada positiva&quot;)),
  NOT(ISPICKVAL(Status, &quot;Gestionada negativa&quot;)),
  NOT(ISPICKVAL(Status, &quot;Desactivada&quot;)),
  ISPICKVAL($User.AV_Funcion__c, &quot;SSCC&quot;),
  $Profile.Name =&quot;AV_Usuario_CaixaBank&quot;,
  NOT($Permission.AV_AvoidBulkApi),
	OR(
        RecordType.DeveloperName = &apos;AV_Priorizador&apos;,
        RecordType.DeveloperName = &apos;AV_AlertaComercial&apos;,
        RecordType.DeveloperName = &apos;AV_MorosidadNormativa&apos;,
        RecordType.DeveloperName = &apos;AV_ConversacionPendiente&apos;,
        RecordType.DeveloperName = &apos;AV_Onboarding&apos;,
        RecordType.DeveloperName = &apos;AV_ExperienciaCliente&apos;,
        RecordType.DeveloperName = &apos;AV_ContactosGCF&apos;,
        RecordType.DeveloperName = &apos;AV_Otros&apos;
    ),
AND(
 !$Permission.AV_ByPassValidationRules,
 !$Permission.CBK_BypassValidationRules 
)
)</errorConditionFormula>
    <errorMessage>No se permite cambiar al estado seleccionado.</errorMessage>
</ValidationRule>
