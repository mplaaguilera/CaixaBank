<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>SAC_PreguntaOficina</fullName>
    <active>true</active>
    <description>Validation rule para no permitir rellenar el campo pregunta de una consulta de oficinas si no se ha rellenado el campo SAC_EmailOficina__c</description>
    <errorConditionFormula>AND(NOT($Permission.SAC_ByPass),
				OR(RecordType.DeveloperName  = &apos;SAC_Consulta&apos;,RecordType.DeveloperName  = &apos;SPV_Consulta&apos;),
				SAC_GrupoColaborador__r.SAC_DeveloperName__c = &apos;OFICINA&apos;,
				OR(AND(
							    PRIORVALUE(SAC_Estado__c) = &apos;&apos;,
							    ISBLANK(SAC_EmailOficina__c),
				       NOT(LEN(SAC_Pregunta__c) = 0),
							    ISCHANGED(SAC_Estado__c)),
							AND(
							ISBLANK(SAC_EmailOficina__c),
				   NOT(LEN(SAC_Pregunta__c) = 0),
							ISCHANGED(SAC_EmailOficina__c))
						 )
			 )</errorConditionFormula>
    <errorMessage>No se puede enviar una pregunta sin tener el email oficina informado</errorMessage>
</ValidationRule>
