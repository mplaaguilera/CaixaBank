<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>CSBD_No_Modificar_WS</fullName>
    <active>true</active>
    <description>Controla que no se puedan modificar los campos Empresa proveedora, Familia de producto, Producto y Nombre  en una oportunidad que ha llegado por WS</description>
    <errorConditionFormula>AND(
AND(
NOT($Permission.CSBD_ByPassVR),
NOT($Permission.CSBD_Administrador)
),
AND(
OR(
BEGINS($Profile.Name, &apos;AM&apos;),
BEGINS($Profile.Name, &apos;AV&apos;),
BEGINS($Profile.Name, &apos;CC&apos;),
BEGINS($Profile.Name, &apos;CSBD&apos;),
BEGINS($Profile.Name, &apos;EV&apos;),
BEGINS($Profile.Name, &apos;OB&apos;),
BEGINS($Profile.Name, &apos;OS&apos;),
BEGINS($Profile.Name, &apos;SAC&apos;),
BEGINS($Profile.Name, &apos;SEG&apos;)
),
BEGINS(RecordType.DeveloperName, &apos;CSBD&apos;),
NOT(RecordType.DeveloperName = &apos;CSBD_MAC&apos;),
OR(
ISCHANGED(CSBD_Empresa_Proveedora__c),
AND (
ISCHANGED(CSBD_Familia_Producto__c),
NOT(ISPICKVAL(PRIORVALUE(CSBD_Familia_Producto__c), &apos;&apos;))
),
AND(
ISCHANGED(CSBD_Producto__c),
NOT(ISPICKVAL(PRIORVALUE(CSBD_Producto__c), &apos;&apos;))
)
),
ISPICKVAL(CSBD_SistemaOrigen__c, &apos;WS&apos;)
)
) &amp;&amp; NOT(ISNEW())</errorConditionFormula>
    <errorMessage>Los campos Empresa proveedora, Familia de producto, Producto no se pueden modificar en una oportunidad con origen Now. Por favor, clona la oportunidad.</errorMessage>
</ValidationRule>
