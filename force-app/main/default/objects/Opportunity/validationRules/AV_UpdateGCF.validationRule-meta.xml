<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>AV_UpdateGCF</fullName>
    <active>false</active>
    <errorConditionFormula>AND(
	OR(
		RecordType.DeveloperName = &quot;AV_Iniciativa&quot;,
		RecordType.DeveloperName = &quot;AV_AlertaComercial&quot;,
		RecordType.DeveloperName = &quot;AV_Propuesta&quot;,
		RecordType.DeveloperName = &quot;AV_Sugerencia&quot;
	),
	$Profile.Name = &quot;API Only&quot;,
	OR(
		ISCHANGED(AV_Comentarios__c),
		ISCHANGED(AV_FechaProximoRecordatorio__c),
		ISCHANGED(StageName)
	),
	OR(
		ISPICKVAL(StageName,&quot;Cerrado positivo&quot;),
		ISPICKVAL(StageName,&quot;No apto&quot;),
		AND(
			ISPICKVAL(StageName,&quot;Vencido&quot;),
			OR(
				ISPICKVAL(PRIORVALUE(StageName),&quot;Cerrado positivo&quot;),
				ISPICKVAL(PRIORVALUE(StageName),&quot;No apto&quot;),
				ISPICKVAL(PRIORVALUE(StageName),&quot;Con Venta&quot;),
				ISPICKVAL(PRIORVALUE(StageName),&quot;No interesado&quot;)
			)
		),
		AND(
			OR(
				ISPICKVAL(StageName,&quot;Potencial&quot;),
				ISPICKVAL(StageName,&quot;En gestión/insistir&quot;)
			),
			OR(
				ISPICKVAL(PRIORVALUE(StageName),&quot;Cerrado positivo&quot;),
				ISPICKVAL(PRIORVALUE(StageName),&quot;No apto&quot;),
				AND(
					ISPICKVAL(PRIORVALUE(StageName),&quot;Con venta&quot;),
					NOT(ISPICKVAL(StageName,&quot;No interesado&quot;))
				)
			)
		)
	)
)</errorConditionFormula>
    <errorMessage>No se pueden modificar los campos etapa, fecha de próxima getión y comentario cuando la etapa es Cerrada positiva, No apto o Con venta</errorMessage>
</ValidationRule>
